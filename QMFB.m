clc; clear all; close all;
n= 99;
fp=0.45;
[h0,h1,g0,g1] = firpr2chfb(n,fp);
% load chirp;
t= -2*pi: 1/1000 :2*pi;
y= sin(5*t);
v0= conv(y,h0);
v0= upsample(downsample(v0,2),2);
inv_v0= conv(fliplr(y),fliplr(h0));
inv_v0= upsample(downsample(inv_v0,2),2);
y0= (1/2).*(conv(v0,g0)+conv(inv_v0,g0));
v1= conv(y,h1);
v1= upsample(downsample(v1,2),2);
inv_v1= conv(fliplr(y),fliplr(h1));
inv_v1= upsample(downsample(inv_v1,2),2);
y1= (1/2).*(conv(v1,g1)+conv(inv_v1,g1));
x= y0 + y1;
freqz(y);
freqz(x);